# CSB DevSecOps Test Repository

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Security Testing](https://img.shields.io/badge/Security-Testing-red.svg)](https://github.com/csb/devsecops-test/security)
[![DevSecOps](https://img.shields.io/badge/DevSecOps-Pipeline-blue.svg)](https://github.com/csb/devsecops-test)

> âš ï¸ **WARNING**: This repository contains **intentional security vulnerabilities** for testing purposes. **DO NOT** deploy to production environments.

## ğŸ¯ Purpose

This repository serves as a comprehensive testing ground for CSB's DevSecOps pipeline, security tools, and CI/CD processes. It contains sample applications across our entire technology stack with intentional security vulnerabilities to validate our security scanning capabilities.

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CSB Technology Stack                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend: React + Angular (TypeScript)                        â”‚
â”‚  Backend: Python + Java + C# + Node.js + PHP                  â”‚
â”‚  Databases: PostgreSQL + MySQL + Oracle                        â”‚
â”‚  Infrastructure: Azure + AWS + Kubernetes                      â”‚
â”‚  Security: Multi-tool scanning pipeline                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Repository Structure

```
csb-devsecops-test/
â”œâ”€â”€ ğŸ–¥ï¸  frontend/                    # Frontend Applications
â”‚   â”œâ”€â”€ react-app/                   # React + TypeScript
â”‚   â””â”€â”€ angular-app/                 # Angular + TypeScript
â”œâ”€â”€ âš™ï¸  backend/                     # Backend Applications  
â”‚   â”œâ”€â”€ python-django/               # Django Web Framework
â”‚   â”œâ”€â”€ python-flask/                # Flask API
â”‚   â”œâ”€â”€ java-springboot/             # Spring Boot API
â”‚   â”œâ”€â”€ java-mulesoft/               # MuleSoft Integration & DataWeave
â”‚   â”œâ”€â”€ csharp-webapi/               # .NET Core Web API
â”‚   â”œâ”€â”€ csharp-etl/                  # C# ETL Automation Tools
â”‚   â”œâ”€â”€ node-express/                # Node.js Express API
â”‚   â””â”€â”€ php-drupal/                  # Drupal 9/10 Application
â”œâ”€â”€ ğŸ—„ï¸  databases/                   # Database Configurations
â”‚   â”œâ”€â”€ postgresql/                  # PostgreSQL schemas & migrations
â”‚   â”œâ”€â”€ mysql/                       # MySQL schemas & migrations
â”‚   â””â”€â”€ oracle/                      # Oracle procedures & schemas
â”œâ”€â”€ ğŸ—ï¸  infrastructure/              # Infrastructure as Code
â”‚   â”œâ”€â”€ terraform/                   # Terraform (Azure, AWS, MuleSoft)
â”‚   â”œâ”€â”€ docker/                      # Docker configurations
â”‚   â””â”€â”€ pantheon/                    # Pantheon hosting configs
â”œâ”€â”€ ğŸ”’ security/                     # Security Configurations
â”‚   â”œâ”€â”€ policies/                    # Network & API security policies
â”‚   â”œâ”€â”€ zap/                         # OWASP ZAP DAST configs
â”‚   â”œâ”€â”€ sbom/                        # Software Bill of Materials
â”‚   â”œâ”€â”€ compliance/                  # SOX, PCI-DSS frameworks
â”‚   â”œâ”€â”€ mulesoft/                    # MuleSoft security configs
â”‚   â””â”€â”€ drupal/                      # Drupal security configurations
â”œâ”€â”€ ğŸš€ .github/workflows/            # CI/CD Pipelines
â”‚   â”œâ”€â”€ ci.yml                       # Main CI workflow
â”‚   â”œâ”€â”€ security.yml                 # Security scanning
â”‚   â”œâ”€â”€ cd.yml                       # Deployment pipeline
â”‚   â”œâ”€â”€ infrastructure.yml           # Infrastructure deployment
â”‚   â”œâ”€â”€ mulesoft.yml                 # MuleSoft/DataWeave pipeline
â”‚   â””â”€â”€ drupal.yml                   # Drupal security pipeline
â”œâ”€â”€ ğŸ“ .semgrep/                     # Custom Security Rules
â”‚   â”œâ”€â”€ csb-custom-rules.yml         # Custom security rules
â”‚   â”œâ”€â”€ java-rules.yml               # Java-specific rules
â”‚   â”œâ”€â”€ typescript-rules.yml         # Frontend security rules
â”‚   â”œâ”€â”€ dataweave-rules.yml          # DataWeave security rules
â”‚   â””â”€â”€ drupal-rules.yml             # Drupal security rules
â”œâ”€â”€ ğŸ› ï¸  scripts/                     # Automation Scripts
â”‚   â”œâ”€â”€ setup/                       # Environment setup scripts
â”‚   â”œâ”€â”€ security/                    # Security scanning scripts
â”‚   â”œâ”€â”€ deployment/                  # Deployment automation
â”‚   â””â”€â”€ mulesoft/                    # MuleSoft-specific scripts
â”œâ”€â”€ ğŸ³ docker-compose.yml            # Local Development Setup
â”œâ”€â”€ ğŸ³ docker-compose.mulesoft.yml   # MuleSoft Services
â”œâ”€â”€ ğŸ³ docker-compose.drupal.yml     # Drupal with Security Tools
â”œâ”€â”€ ğŸ”§ .devcontainer/                # GitHub Codespaces Config
â”œâ”€â”€ ğŸ” .pre-commit-config.yaml       # Pre-commit Security Hooks
â””â”€â”€ ğŸ“š docs/                         # Documentation
    â”œâ”€â”€ SECURITY.md                  # Security guidelines
    â”œâ”€â”€ MULESOFT_SECURITY.md         # MuleSoft security guide
    â”œâ”€â”€ DRUPAL_SECURITY.md           # Drupal security guide
    â”œâ”€â”€ ARCHITECTURE.md              # System architecture
    â””â”€â”€ DEPLOYMENT.md                # Deployment guide
```

## ğŸš€ Quick Start

### Prerequisites

- [Docker](https://docs.docker.com/get-docker/) & [Docker Compose](https://docs.docker.com/compose/install/)
- [Node.js](https://nodejs.org/) (v16+)
- [Python](https://www.python.org/) (3.9+)
- [Git](https://git-scm.com/)

### Option 1: GitHub Codespaces (Recommended) â˜ï¸

**GitHub Codespaces provides a pre-configured cloud development environment with all tools installed.**

#### ğŸš€ Launch Codespaces

1. **Open in Codespaces:**
   ```bash
   # From GitHub repository page, click:
   # Code â†’ Codespaces â†’ Create codespace on main
   ```
   Or use the direct link: [![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://codespaces.new/csb/devsecops-test)

2. **Wait for Environment Setup:**
   The codespace will automatically:
   - âœ… Install all required tools (Docker, Node.js, Python, security tools)
   - âœ… Configure pre-commit hooks
   - âœ… Set up development environment
   - âœ… Install security scanning tools

#### ğŸ”§ Codespaces Configuration

The repository includes a `.devcontainer/devcontainer.json` configuration:

```json
{
  "name": "CSB DevSecOps Test Environment",
  "image": "mcr.microsoft.com/devcontainers/universal:2",
  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {},
    "ghcr.io/devcontainers/features/node:1": {"version": "18"},
    "ghcr.io/devcontainers/features/python:1": {"version": "3.9"}
  },
  "postCreateCommand": ".devcontainer/setup.sh",
  "forwardPorts": [3000, 3001, 4200, 5000, 8000, 8080, 8081, 8090, 8888],
  "portsAttributes": {
    "3000": {"label": "React App", "onAutoForward": "notify"},
    "4200": {"label": "Angular App", "onAutoForward": "notify"},
    "8000": {"label": "Django API", "onAutoForward": "notify"},
    "8080": {"label": "Spring Boot API", "onAutoForward": "notify"}
  }
}
```

#### ğŸƒâ€â™‚ï¸ Running Tests in Codespaces

Once your codespace is ready:

```bash
# 1. Start all services
chmod +x ./start-with-dependencies.sh
./start-with-dependencies.sh

# 2. Wait for services to be ready (about 60 seconds)
sleep 60

# 3. Run comprehensive security scans
./scripts/security/run-security-scans.sh

# 4. View individual application logs
docker-compose logs spring-boot-api
docker-compose logs django-app

# 5. Access applications through forwarded ports
# Codespaces will automatically forward and provide URLs for:
# - React App (port 3000)
# - Angular App (port 4200) 
# - Django API (port 8000)
# - Spring Boot API (port 8080)
# - All other services...
```

#### ğŸ”’ Security Testing in Codespaces

**Pre-installed Security Tools:**
```bash
# Verify security tools are available
semgrep --version
snyk --version  
trufflehog --version
docker run --rm owasp/zap2docker-stable --version

# Run individual security scans
semgrep --config=p/security-audit .
snyk test --all-projects
trufflehog git file://. --only-verified
```

**Manual Testing Commands:**
```bash
# Test specific vulnerabilities
curl "http://localhost:8080/api/users/1'; DROP TABLE users; --"  # SQL injection test
curl -X POST -H "Content-Type: application/json" \
  -d '{"username":"<script>alert(1)</script>"}' \
  http://localhost:8080/api/login  # XSS test

# Check for sensitive data exposure
curl http://localhost:8080/api/users/1 | grep -i "password\|ssn\|credit"
```

#### ğŸ“Š View Security Reports in Codespaces

```bash
# Generate comprehensive security report
./scripts/security/run-security-scans.sh

# View reports in VS Code
code security-reports/security-summary.md

# Open security reports in browser
python3 -m http.server 8000 --directory security-reports
# Then access via forwarded port 8000
```

#### ğŸ’¡ Codespaces Benefits for Security Testing

âœ… **Isolated Environment:** No risk to your local machine  
âœ… **Pre-configured Tools:** All security tools pre-installed  
âœ… **Consistent Environment:** Same setup for all team members  
âœ… **Port Forwarding:** Easy access to all applications  
âœ… **VS Code Integration:** Full IDE experience in browser  
âœ… **Git Integration:** Seamless GitHub integration  
âœ… **Secrets Management:** GitHub secrets available in codespace  

#### ğŸ› ï¸ Codespaces Troubleshooting

<details>
<summary>ğŸ› Services not starting in Codespaces</summary>

```bash
# Check Docker status
sudo systemctl status docker

# Restart Docker if needed
sudo systemctl restart docker

# Check available resources
df -h
free -h

# Restart services with more memory
docker-compose down
docker-compose up -d --memory=2g
```
</details>

<details>
<summary>ğŸ”§ Security tools not working</summary>

```bash
# Reinstall security tools
pip install --upgrade semgrep
npm install -g snyk

# Re-run setup script
.devcontainer/setup.sh

# Check PATH
echo $PATH
which semgrep snyk trufflehog
```
</details>

### Option 2: Local Development

#### 1. Clone & Setup

```bash
# Clone the repository
git clone https://github.com/csb/devsecops-test.git
cd devsecops-test

# Run automated setup
chmod +x scripts/setup/setup-dev-environment.sh
./scripts/setup/setup-dev-environment.sh
```

### 2. Configure GitHub Secrets

In your GitHub repository settings, add these secrets:

```bash
SEMGREP_APP_TOKEN=your_semgrep_token_here
SNYK_TOKEN=your_snyk_token_here
```

**For Codespaces:** These secrets are automatically available in your codespace environment.

**For Local Development:** You'll need to export these as environment variables:
```bash
export SEMGREP_APP_TOKEN=your_semgrep_token_here  
export SNYK_TOKEN=your_snyk_token_here
```

### 3. Start the Application Stack

```bash
# Start all services
docker-compose up -d

# Verify services are running
docker-compose ps
```

### 4. Access Applications

| Service | URL | Description |
|---------|-----|-------------|
| **React App** | http://localhost:3000 | Frontend React application |
| **Angular App** | http://localhost:4200 | Frontend Angular application |
| **Django API** | http://localhost:8000 | Python Django backend |
| **Flask API** | http://localhost:5000 | Python Flask API |
| **Spring Boot** | http://localhost:8080 | Java Spring Boot API |
| **.NET Core** | http://localhost:8090 | C# .NET Core Web API |
| **Node.js API** | http://localhost:3001 | Node.js Express API |
| **PHP/Drupal** | http://localhost:8888 | PHP Drupal application |
| **Adminer** | http://localhost:8081 | Database administration |

## ğŸ”’ Security Testing

### Automated Security Pipeline

Our CI/CD pipeline includes comprehensive security scanning:

```
Code Commit â†’ Pre-commit Hooks â†’ Secret Scanning â†’ SAST Analysis 
     â†“              â†“                    â†“              â†“
Dependency Scan â†’ Container Scan â†’ DAST Testing â†’ Compliance Check
     â†“              â†“                    â†“              â†“
   Security Report Generated â†’ Findings Published â†’ Action Required
```

### Security Tools Integration

| Tool | Purpose | Coverage |
|------|---------|----------|
| **GitHub Advanced Security** | SAST, Secrets, Dependencies | Native GitHub integration |
| **Semgrep** | Custom SAST rules | All languages + custom CSB rules |
| **Snyk** | Dependency vulnerabilities | All package managers |
| **OWASP ZAP** | Dynamic security testing | All web applications |
| **Trivy** | Container vulnerability scanning | All Docker images |
| **tfsec** | Terraform security analysis | Infrastructure as Code |
| **Checkov** | Infrastructure security | Multi-cloud policies |
| **TruffleHog** | Advanced secret detection | Git history + custom patterns |

### Manual Security Scans

```bash
# Run comprehensive security analysis
./scripts/security/run-security-scans.sh

# View security reports
ls -la security-reports/

# Generate compliance report
./scripts/security/compliance-check.sh
```

## ğŸ§ª Intentional Vulnerabilities

This repository contains **intentional security vulnerabilities** for testing purposes:

### ğŸ”´ Critical Findings (Expected: 20+)
- **Hardcoded Secrets**: Database passwords, API keys, AWS credentials
- **SQL Injection**: Dynamic query construction in all backend languages  
- **Command Injection**: Unsafe system command execution
- **Path Traversal**: Unvalidated file path operations

### ğŸŸ¡ High Findings (Expected: 30+)
- **Weak Cryptography**: MD5 hashing, weak random number generation
- **Cross-Site Scripting (XSS)**: Unsafe HTML rendering
- **Insecure Direct Object References**: Unvalidated user input
- **Security Misconfiguration**: Debug mode, overly permissive settings

### ğŸŸ  Medium Findings (Expected: 50+)
- **Vulnerable Dependencies**: Outdated packages with known CVEs
- **Information Disclosure**: Logging of sensitive data
- **Insufficient Input Validation**: Missing sanitization
- **Insecure Communication**: HTTP instead of HTTPS

## ğŸ“Š Expected Security Scan Results

When you run the complete security pipeline, expect these findings:

```
ğŸ” Security Scan Summary
â”œâ”€â”€ ğŸ“Š Total Findings: 100+
â”œâ”€â”€ ğŸ”´ Critical: 20+ findings
â”œâ”€â”€ ğŸŸ¡ High: 30+ findings  
â”œâ”€â”€ ğŸŸ  Medium: 50+ findings
â””â”€â”€ ğŸŸ¢ Low: 25+ findings

ğŸ› ï¸ Tools Results:
â”œâ”€â”€ CodeQL: 25+ code quality & security issues
â”œâ”€â”€ Semgrep: 40+ SAST findings (custom rules)
â”œâ”€â”€ Snyk: 30+ dependency vulnerabilities
â”œâ”€â”€ Trivy: 20+ container vulnerabilities
â”œâ”€â”€ OWASP ZAP: 15+ web application issues
â”œâ”€â”€ tfsec: 10+ infrastructure misconfigurations
â””â”€â”€ TruffleHog: 15+ hardcoded secrets
```

## ğŸ›ï¸ Compliance Testing

### Banking Regulations Covered

- **SOX (Sarbanes-Oxley)**: Audit trails, financial data protection
- **PCI DSS**: Credit card data security requirements  
- **SOC 2 Type II**: Security and availability controls
- **NIST Cybersecurity Framework**: Comprehensive security controls

### Compliance Validation

```bash
# Run compliance checks
./scripts/security/compliance-check.sh

# Generate compliance reports
cat security-reports/compliance-report.md
```

## ğŸ—ï¸ Infrastructure Testing

### Cloud Platforms
- **Azure**: Primary cloud with AKS, App Service, Key Vault
- **AWS**: Secondary cloud with EKS, RDS, Secrets Manager

### Infrastructure as Code
- **Terraform**: Multi-cloud infrastructure provisioning
- **Kubernetes**: Container orchestration with security policies

### Security Policies
- Network security groups and policies
- Pod security policies and standards
- RBAC and identity management
- Secrets management and rotation

## ğŸš€ CI/CD Pipeline

### GitHub Actions Workflows

| Workflow | Trigger | Purpose |
|----------|---------|---------|
| **ci.yml** | Push, PR | Comprehensive security testing |
| **security.yml** | Daily | Scheduled security scans |
| **cd.yml** | Main branch | Deployment pipeline |
| **infrastructure.yml** | IaC changes | Infrastructure security |

### Pipeline Stages

1. **Pre-commit Security Gates**
   - Secret scanning with TruffleHog
   - Basic SAST with Semgrep
   - Code formatting and linting

2. **Build & Security Analysis**
   - Multi-language compilation
   - Comprehensive SAST scanning
   - Dependency vulnerability analysis
   - Container security scanning

3. **Dynamic Security Testing**
   - OWASP ZAP web application scanning
   - API security testing
   - Integration security tests

4. **Compliance & Reporting**
   - Regulatory compliance validation
   - Security report generation
   - Artifact publication

## ğŸ› ï¸ Development Workflow

### Local Development

```bash
# Install pre-commit hooks
pre-commit install

# Start development environment
docker-compose up -d

# Run tests for specific application
cd backend/java-springboot
./mvnw test

# Run security scans locally
semgrep --config=p/security-audit --config=.semgrep/csb-custom-rules.yml
```

### Contributing Security Tests

1. **Add New Vulnerabilities**:
   ```bash
   # Add new intentional vulnerability
   # Update corresponding test cases
   # Document the vulnerability type
   ```

2. **Create Custom Security Rules**:
   ```yaml
   # .semgrep/new-rules.yml
   rules:
     - id: custom-vulnerability-pattern
       pattern: |
         dangerous_function($VAR)
       message: "Custom security issue detected"
       severity: ERROR
   ```

3. **Update Test Cases**:
   ```bash
   # Add tests that verify security scanners detect new vulnerabilities
   # Update expected findings count
   # Document new compliance requirements
   ```

## ğŸ“ˆ Monitoring & Metrics

### Security Metrics Dashboard

Track the effectiveness of your security pipeline:

- **Vulnerability Detection Rate**: % of vulnerabilities caught by scanning
- **False Positive Rate**: Quality of security tool configurations  
- **Time to Detection**: How quickly new vulnerabilities are found
- **Time to Remediation**: Speed of vulnerability fixes
- **Pipeline Performance**: Impact of security scanning on build times

### Key Performance Indicators

```bash
# Security Pipeline KPIs
â”œâ”€â”€ ğŸ¯ Vulnerability Detection: 95%+ 
â”œâ”€â”€ ğŸ“Š False Positive Rate: <10%
â”œâ”€â”€ â±ï¸ Scan Duration: <15 minutes
â”œâ”€â”€ ğŸ”„ Pipeline Success Rate: >95%
â””â”€â”€ ğŸ“‹ Compliance Score: 100%
```

## ğŸ†˜ Troubleshooting

### Common Issues

<details>
<summary>ğŸ› Services not starting properly</summary>

```bash
# Check service logs
docker-compose logs [service-name]

# Restart specific service
docker-compose restart [service-name]

# Rebuild containers
docker-compose up --build -d
```
</details>

<details>
<summary>ğŸ”’ Security scans failing</summary>

```bash
# Check tool installations
semgrep --version
snyk --version
trufflehog --version

# Verify GitHub secrets are set
# Check API token permissions
# Review scan configurations
```
</details>

<details>
<summary>ğŸ’¾ Database connection issues</summary>

```bash
# Check database containers
docker-compose ps postgres mysql oracle

# Verify database initialization
docker-compose logs postgres

# Connect manually to test
docker-compose exec postgres psql -U postgres -d csbdb
```
</details>

### Getting Help

- ğŸ“– **Documentation**: Check the `/docs` folder for detailed guides
- ğŸ« **Issues**: Create GitHub issues for bugs or feature requests  
- ğŸ’¬ **Slack**: #devops-support for real-time assistance
- ğŸ“§ **Email**: devops@csb.com for security-related questions

## ğŸ“š Additional Resources

### Documentation
- [Security Testing Guide](docs/SECURITY.md)
- [API Documentation](docs/API_DOCUMENTATION.md)
- [Architecture Overview](docs/ARCHITECTURE.md)
- [Deployment Guide](docs/DEPLOYMENT.md)

### External Resources
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)
- [DevSecOps Best Practices](https://www.devsecops.org/)
- [Banking Security Regulations](https://www.ffiec.gov/cyberresources.htm)

## ğŸ¤ Contributing

We welcome contributions to improve our security testing capabilities:

1. **Fork** the repository
2. **Create** a feature branch (`git checkout -b feature/new-security-test`)
3. **Add** your security tests or improvements
4. **Commit** your changes (`git commit -am 'Add new security test'`)
5. **Push** to the branch (`git push origin feature/new-security-test`)
6. **Create** a Pull Request

### Contribution Guidelines

- âœ… Add intentional vulnerabilities with clear documentation
- âœ… Include corresponding test cases
- âœ… Update security scan expectations
- âœ… Follow existing code style and patterns
- âœ… Include appropriate security warnings

## âš–ï¸ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## âš ï¸ Security Disclaimer

**IMPORTANT**: This repository contains intentional security vulnerabilities for testing purposes only. These vulnerabilities include:

- Hardcoded secrets and credentials
- SQL injection vulnerabilities  
- Cross-site scripting (XSS) issues
- Path traversal vulnerabilities
- Weak cryptographic implementations
- Command injection opportunities

**DO NOT**:
- Deploy this code to production environments
- Use these patterns in real applications
- Expose these services to the public internet
- Use the hardcoded credentials for actual systems

**USE ONLY** for:
- Security tool testing and validation
- DevSecOps pipeline development
- Security training and education
- Compliance testing in isolated environments

## ğŸ“ Support

For questions, issues, or support:

- **Security Issues**: security@cambridgesavings.com
- **DevOps Support**: mfrommelt@csb.com  
- **General Questions**: Create a GitHub issue

---

**Happy Security Testing! ğŸ”’ğŸš€**

*Built with â¤ï¸ by the CSB DevSecOps Team*